<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="stylesheet" th:href="@{/CSS/Inicio.css}" />
  <!-- Componentes -->
  <link rel="stylesheet" th:href="@{/CSS/Componentes/Globales.css}" />
  <link rel="stylesheet" th:href="@{/CSS/Componentes/Navbar.css}" />
  <link rel="stylesheet" th:href="@{/CSS/Componentes/BarraBusqueda.css}" />
  <link rel="stylesheet" th:href="@{/CSS/Componentes/Modales.css}" />
  <link rel="stylesheet" th:href="@{/CSS/Componentes/Perfil.css}" />
  <link rel="stylesheet" th:href="@{/CSS/Componentes/ModoOscuro.css}" />
</head>

<body>

  <!-- Navbar -->
  <div th:replace="/fragments/Navbar :: Navbar"></div>

  <!-- Barra de búsqueda -->
  <div th:replace="/fragments/BarraBusqueda :: BarraBusqueda"></div>

  <!-- Perfil -->
  <div th:replace="/fragments/Perfil :: Perfil"></div>

  <!-------------------------------------------------Tabla de etequitas--------------------------------------------------->
  <div class="container-tabla">

    <!-- Título de la tabla-->
    <h2 class="mb-3 titulo">Listado de Etiquetas</h2>

    <!-- Tabla Responsive-->
    <div class="table-responsive">

      <table id="tablaTareas" class="table table-light table-hover align-middle text-center ">

        <!-- Encabezados de la tabla -->
        <thead class="table-responsive">
          <tr>
            <th>Cod</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Color</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <!---------------------------------------- Ejemplos ------------------------------------------------>
        <tbody class="table-responsive">
          <tr th:each="etiquetas : ${etiquetas}">
            <td th:text="${etiquetas.id}"></td>
            <td th:text="${etiquetas.nombre}"></td>
            <td th:text="${etiquetas.descripcion}"></td>
            <td th:text="${etiquetas.color}"></td>

            <td class="td-acciones">
              <div class="d-flex justify-content-center gap-2 p-2">
                <button class="btn btn-sm btn-editar" data-bs-toggle="modal" data-bs-target="#modalEditarTarea">
                  <i class="bi bi-pen-fill"></i>
                </button>
                <button class="btn btn-sm btn-eliminar" data-bs-toggle="modal" data-bs-target="#modalEliminarEtiqueta"
                  th:attr="data-id=${etiquetas.id}">
                  <i class="bi bi-trash-fill"></i>
                </button>

              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!--------------------------------------------------- Modal Eliminar Tarea -------------------------------------------------->
  <div class="modal fade" id="modalEliminarEtiqueta" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
      <div class="modal-content border-0 modal-redondeado">
        <div class="card-body p-4">

          <!-- Titulo de modal -->
          <div class="text-center mb-4">
            <div class="logo-modal">
              <img src="../Recursos/Img/LogoSolo.png" alt="Logo" class="img-fluid mb-0" style="width: 70px;">
            </div>
            <h2 class="titulo-modal mt-3 mb-3">¡Eliminar Etiqueta!</h2>
            <p class="mb-0">¿Está seguro de querer eliminar esta etiqueta?</p>
          </div>

          <!-- Botones de acción (Confirmar y Cancelar) -->
          <div class="d-flex justify-content-center gap-3 mt-4">
            <form id="formEliminarEtiqueta" method="post" style="display: inline;">
              <button type="submit" class="btn-modal">Confirmar</button>
            </form>
            <button type="button" class="btn-cancelar" data-bs-dismiss="modal">Cancelar</button>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-----------------------------------------------Botón nueva etiqueta--------------------------------------------------->
  <div class="boton-nueva-tarea position-fixed bottom-0 end-0 p-4">
    <button class="btn-nueva-tarea" data-bs-toggle="modal" data-bs-target="#modalNuevaTarea">
      <i class="bi bi-plus-circle-fill fs-3"></i>
    </button>
  </div>

  <script>
    const modalEliminar = document.getElementById('modalEliminarEtiqueta');
    modalEliminar.addEventListener('show.bs.modal', function (event) {
      const button = event.relatedTarget; // botón que abrió el modal
      const id = button.getAttribute('data-id'); // obtener ID
      const form = document.getElementById('formEliminarEtiqueta');
      form.action = '/eliminarEtiqueta/' + id; // actualizar acción del formulario
    });
  </script>

  <script src="../JavaScript/ModoOscuro.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>